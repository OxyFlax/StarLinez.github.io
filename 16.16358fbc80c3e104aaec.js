(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{Vw9Y:function(e,t,a){"use strict";a.r(t),a.d(t,"MaplestoryWeekliesV2Module",function(){return D});var s=a("ofXK"),r=a("tyNb"),i=a("twyJ"),n=a("fXoL"),l=a("jhN1"),o=a("/SLC"),c=a("kN8N"),h=a("Iwn8"),k=a("Ajqu");function p(e,t){if(1&e){const e=n.Mb();n.Lb(0,"app-task-topbar-default",6),n.Sb("changeEvent",function(){return n.hc(e),n.Vb().changeHandler()}),n.Kb()}if(2&e){const e=n.Vb();n.Yb("taskData",e.weekliesData)("topBarTitle","Weekly Tracker")("editButtonTitle","Weeklies")}}function g(e,t){if(1&e){const e=n.Mb();n.Lb(0,"app-task-topbar-editmode",7),n.Sb("changeEvent",function(){return n.hc(e),n.Vb().changeHandler()})("regionChangeEvent",function(){return n.hc(e),n.Vb().regionChangeHandler()}),n.Kb()}if(2&e){const e=n.Vb();n.Yb("taskData",e.weekliesData)("topBarTitle","Weekly Tracker")}}function u(e,t){1&e&&(n.Lb(0,"div"),n.mc(1,' All weeklies are disabled, click on the "Edit Weeklies" button to enable weeklies. '),n.Kb())}function d(e,t){if(1&e){const e=n.Mb();n.Jb(0),n.Lb(1,"app-task-group",8),n.Sb("changeEvent",function(){return n.hc(e),n.Vb().changeHandler()}),n.Kb(),n.Ib()}if(2&e){const e=t.$implicit,a=t.index,s=n.Vb();n.wb(1),n.Yb("taskData",s.weekliesData)("taskGroup",e)("title",e.title)("timerString",s.timerStrings[a])}}const m=[{path:"",component:(()=>{class e{constructor(e,t){this.titleService=e,this.metaService=t,this.characterIndex=0,this.timers=[],this.timerStrings=["",""]}ngOnInit(){this.titleService.setTitle("Maplestory Weeklies Tracker | Random Stuff"),this.metaService.updateTag({name:"description",content:"A weeklies tracker for Maplestory to keep track of your completed weekly tasks. Keep track of your weeklies across multiple different characters."}),this.metaService.getTag("name='robots'")?this.metaService.updateTag({name:"robots",content:"index, follow"}):this.metaService.addTag({name:"robots",content:"index, follow"}),this.initialise()}ngOnDestroy(){this.timers[0]&&clearInterval(this.timers[0]),this.timers[1]&&clearInterval(this.timers[1])}initialise(){localStorage.getItem("weekliesData")?(this.weekliesData=JSON.parse(localStorage.getItem("weekliesData")),this.weekliesData.editModeActive=!1,this.updateChecker(),this.weeklyDataChecker(),this.checkIfAllGroupsAreDisabled()):localStorage.getItem("weeklies")?this.v1v2Updater():this.initiateDataSet(),this.startTimer(0),this.startTimer(1)}v1v2Updater(){var e={characters:[],version:localStorage.getItem("weekliesVersion"),lastTrackerVisit:localStorage.getItem("lastMapleWeeklyTrackerVisit"),selectedCharacterIndex:0,mapleRegion:[{resetUtcOffset:0,name:"GMS"},{resetUtcOffset:8,name:"MSEA"},{resetUtcOffset:9,name:"KMS"}][JSON.parse(localStorage.getItem("mapleRegion"))],editModeActive:!1},t=JSON.parse(localStorage.getItem("weeklies"));for(let a=0;a<t.length;a++)e.characters.push({characterName:t[a].characterName,taskGroups:[{title:"Weekly Bosses",tasks:t[a].weeklyBosses,allDisabled:!1},{title:"Weekly Tasks",tasks:t[a].weeklyTasks,allDisabled:!1}]});this.weekliesData=e,this.changeHandler(),localStorage.removeItem("weekliesVersion"),localStorage.removeItem("lastMapleWeeklyTrackerVisit"),localStorage.removeItem("weeklies"),this.initialise()}initiateDataSet(){var e={characterName:"",taskGroups:[{title:"Weekly Bosses",tasks:i.weeklyBosses,allDisabled:!1},{title:"Weekly Tasks",tasks:i.weeklyTasks,allDisabled:!1}]},t={characters:[],version:i.version,lastTrackerVisit:Date.now().toString(),selectedCharacterIndex:0,mapleRegion:{resetUtcOffset:0,name:"GMS"},editModeActive:!1};for(let a=0;a<4;a++)e.characterName="Char"+(a+1),t.characters[a]=JSON.parse(JSON.stringify(e));this.weekliesData=t,this.changeHandler()}weeklyDataChecker(){var e=this.getPreviousDayOfWeek(4),t=this.getPreviousDayOfWeek(1),a=parseInt(this.weekliesData.lastTrackerVisit);a<e&&this.resetCompletedValues(0),a<t&&this.resetCompletedValues(1),this.weekliesData.lastTrackerVisit=Date.now().toString(),this.changeHandler()}getNextDayOfWeek(e){var t=new Date,a=new Date(Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),0,0,0,0));a.setTime(a.getTime()+24*((7+e-a.getUTCDay()-1)%7+1)*60*60*1e3);var s=a.valueOf();return(s-=60*this.weekliesData.mapleRegion.resetUtcOffset*60*1e3)<t.getTime()&&(s+=6048e5),s}getPreviousDayOfWeek(e){return this.getNextDayOfWeek(e)-6048e5}updateChecker(){if(this.weekliesData.version!=i.version){var e=JSON.parse(JSON.stringify(this.weekliesData));this.initiateDataSet();var t=JSON.parse(JSON.stringify(this.weekliesData));for(let a=0;a<e.characters.length;a++){this.weekliesData.characters[a].characterName=e.characters[a].characterName;for(let s=0;s<this.weekliesData.characters[a].taskGroups.length;s++){this.weekliesData.characters[a].taskGroups[s].tasks=[];for(let r=0;r<e.characters[a].taskGroups[s].tasks.length;r++)if("custom"!=e.characters[a].taskGroups[s].tasks[r].type&&"Custom.png"!=e.characters[a].taskGroups[s].tasks[r].image)for(let i=0;i<t.characters[a].taskGroups[s].tasks.length;i++)e.characters[a].taskGroups[s].tasks[r].name==t.characters[a].taskGroups[s].tasks[i].name&&(this.weekliesData.characters[a].taskGroups[s].tasks.push({name:e.characters[a].taskGroups[s].tasks[r].name,image:t.characters[a].taskGroups[s].tasks[i].image,completed:e.characters[a].taskGroups[s].tasks[r].completed,enabled:e.characters[a].taskGroups[s].tasks[r].enabled,type:t.characters[a].taskGroups[s].tasks[i].type,displayCondition:t.characters[a].taskGroups[s].tasks[i].displayCondition}),t.characters[a].taskGroups[s].tasks.splice(i,1));else e.characters[a].taskGroups[s].tasks[r].type="custom","Custom.png"==e.characters[a].taskGroups[s].tasks[r].image&&(e.characters[a].taskGroups[s].tasks[r].image="assets/Games/Maplestory/Tracker/Custom.png"),this.weekliesData.characters[a].taskGroups[s].tasks.push(e.characters[a].taskGroups[s].tasks[r]);for(let e=0;e<t.characters[a].taskGroups[s].tasks.length;e++)this.weekliesData.characters[a].taskGroups[s].tasks.push({name:t.characters[a].taskGroups[s].tasks[e].name,image:t.characters[a].taskGroups[s].tasks[e].image,completed:t.characters[a].taskGroups[s].tasks[e].completed,enabled:t.characters[a].taskGroups[s].tasks[e].enabled,type:t.characters[a].taskGroups[s].tasks[e].type,displayCondition:t.characters[a].taskGroups[s].tasks[e].displayCondition})}}this.weekliesData.version=i.version,this.weekliesData.lastTrackerVisit=Date.now().toString(),this.weekliesData.selectedCharacterIndex=e.selectedCharacterIndex,this.weekliesData.mapleRegion=e.mapleRegion,this.changeHandler()}}startTimer(e){var t;clearInterval(this.timers[e]),t=this.getNextDayOfWeek(0==e?4:1),this.calculateAndOutPutTimes(t-(new Date).getTime(),e),this.timers[e]=setInterval(()=>{var a=t-(new Date).getTime();this.calculateAndOutPutTimes(a,e),a<0&&(clearInterval(this.timers[e]),this.liveReset(e))},1e3)}calculateAndOutPutTimes(e,t){if(e<0)this.timerStrings[t]="RESET!";else{var a=Math.floor(e/864e5),s=Math.floor(e%864e5/36e5),r=Math.floor(e%36e5/6e4),i=Math.floor(e%6e4/1e3);this.timerStrings[t]=a+"d "+s+"h "+r+"m "+("00"+i).slice(-2)+"s "}}liveReset(e){this.resetCompletedValues(e),this.startTimer(e),this.weekliesData.lastTrackerVisit=(parseInt(Date.now().toString())+5e3).toString(),this.changeHandler()}resetCompletedValues(e){this.weekliesData.characters.forEach(t=>{t.taskGroups[e].tasks.forEach(e=>{e.completed=!1})})}changeHandler(){localStorage.setItem("weekliesData",JSON.stringify(this.weekliesData)),this.checkIfAllGroupsAreDisabled()}checkIfAllGroupsAreDisabled(){this.allGroupsAreDisabled=!this.weekliesData.characters[this.weekliesData.selectedCharacterIndex].taskGroups.some(e=>!e.allDisabled)}regionChangeHandler(){this.weeklyDataChecker(),this.startTimer(0),this.startTimer(1)}}return e.\u0275fac=function(t){return new(t||e)(n.Gb(l.c),n.Gb(l.b))},e.\u0275cmp=n.Ab({type:e,selectors:[["app-maplestory-weeklies-v2"]],decls:7,vars:4,consts:[[1,"gamePageContent"],[3,"taskData","topBarTitle","editButtonTitle","changeEvent",4,"ngIf"],[3,"taskData","topBarTitle","changeEvent","regionChangeEvent",4,"ngIf"],[1,"dailyGroups"],[4,"ngIf"],[4,"ngFor","ngForOf"],[3,"taskData","topBarTitle","editButtonTitle","changeEvent"],[3,"taskData","topBarTitle","changeEvent","regionChangeEvent"],[3,"taskData","taskGroup","title","timerString","changeEvent"]],template:function(e,t){1&e&&(n.Hb(0,"app-maplestory-side-navigation"),n.Lb(1,"div",0),n.lc(2,p,1,3,"app-task-topbar-default",1),n.lc(3,g,1,2,"app-task-topbar-editmode",2),n.Lb(4,"div",3),n.lc(5,u,2,0,"div",4),n.lc(6,d,2,4,"ng-container",5),n.Kb(),n.Kb()),2&e&&(n.wb(2),n.Yb("ngIf",!t.weekliesData.editModeActive),n.wb(1),n.Yb("ngIf",t.weekliesData.editModeActive),n.wb(2),n.Yb("ngIf",t.allGroupsAreDisabled&&!t.weekliesData.editModeActive),n.wb(1),n.Yb("ngForOf",t.weekliesData.characters[t.weekliesData.selectedCharacterIndex].taskGroups))},directives:[o.a,s.k,s.j,c.a,h.a,k.a],styles:[".gamePageContent[_ngcontent-%COMP%]{position:relative}.taskGroupWrapper[_ngcontent-%COMP%]{display:inline-block;margin:0 7px;vertical-align:top}.taskGroupTitle[_ngcontent-%COMP%]{margin:0;font-size:20px;width:262px}.disableMode[_ngcontent-%COMP%]{width:100px;height:50px}.dailyGroups[_ngcontent-%COMP%]{width:100%;height:100%;overflow:hidden;text-align:center}.buttonWrapper[_ngcontent-%COMP%]{width:175px;margin:0 auto}.buttonWrapper[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0}.buttonWrapper[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]{float:left}.buttonWrapper[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{float:right}"]}),e})()}];let f=(()=>{class e{}return e.\u0275mod=n.Eb({type:e}),e.\u0275inj=n.Db({factory:function(t){return new(t||e)},imports:[[r.d.forChild(m)],r.d]}),e})();var w=a("I9VR"),b=a("Svul");let D=(()=>{class e{}return e.\u0275mod=n.Eb({type:e}),e.\u0275inj=n.Db({factory:function(t){return new(t||e)},imports:[[s.b,f,w.a,b.a],b.a]}),e})()}}]);